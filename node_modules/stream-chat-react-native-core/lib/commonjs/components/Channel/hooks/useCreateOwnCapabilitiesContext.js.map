{"version":3,"names":["_react","require","_OwnCapabilitiesContext","useCreateOwnCapabilitiesContext","_ref","_channel$data","_channel$data3","channel","overrideCapabilities","_useState","useState","JSON","stringify","data","own_capabilities","_useState2","_slicedToArray2","setOwnCapabilites","overrideCapabilitiesStr","Object","values","useEffect","_channel$data2","listener","on","event","unsubscribe","ownCapabilitiesContext","useMemo","capabilities","keys","allOwnCapabilities","reduce","result","capability","_overrideCapabilities","_extends3","_defineProperty2","includes","id","exports"],"sources":["useCreateOwnCapabilitiesContext.ts"],"sourcesContent":["import { useEffect, useMemo, useState } from 'react';\n\nimport type { Channel } from 'stream-chat';\n\nimport {\n  allOwnCapabilities,\n  OwnCapabilitiesContextValue,\n  OwnCapability,\n} from '../../../contexts/ownCapabilitiesContext/OwnCapabilitiesContext';\nimport type { DefaultStreamChatGenerics } from '../../../types/types';\n\nexport const useCreateOwnCapabilitiesContext = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>({\n  channel,\n  overrideCapabilities,\n}: {\n  channel: Channel<StreamChatGenerics>;\n  overrideCapabilities?: Partial<OwnCapabilitiesContextValue>;\n}) => {\n  const [own_capabilities, setOwnCapabilites] = useState(\n    JSON.stringify(channel.data?.own_capabilities as Array<string>),\n  );\n  const overrideCapabilitiesStr = overrideCapabilities\n    ? JSON.stringify(Object.values(overrideCapabilities))\n    : null;\n\n  // Effect to watch for changes in channel.data?.own_capabilities and update the own_capabilties state accordingly.\n  useEffect(() => {\n    setOwnCapabilites(JSON.stringify(channel.data?.own_capabilities as Array<string>));\n  }, [channel.data?.own_capabilities]);\n\n  // Effect to listen to the `capabilities.changed` event.\n  useEffect(() => {\n    const listener = channel.on('capabilities.changed', (event) => {\n      if (event.own_capabilities) {\n        setOwnCapabilites(JSON.stringify(event.own_capabilities as Array<string>));\n      }\n    });\n\n    return () => {\n      listener.unsubscribe();\n    };\n  }, []);\n\n  const ownCapabilitiesContext: OwnCapabilitiesContextValue = useMemo(() => {\n    const capabilities = (own_capabilities || []) as Array<string>;\n    const ownCapabilitiesContext = Object.keys(allOwnCapabilities).reduce(\n      (result, capability) => ({\n        ...result,\n        [capability]:\n          overrideCapabilities?.[capability as OwnCapability] ??\n          !!capabilities.includes(allOwnCapabilities[capability as OwnCapability]),\n      }),\n      {} as OwnCapabilitiesContextValue,\n    );\n\n    return ownCapabilitiesContext;\n  }, [channel.id, overrideCapabilitiesStr, own_capabilities]);\n\n  return ownCapabilitiesContext;\n};\n"],"mappings":";;;;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AAIA,IAAAC,uBAAA,GAAAD,OAAA;AAOO,IAAME,+BAA+B,GAAG,SAAlCA,+BAA+BA,CAAAC,IAAA,EAQtC;EAAA,IAAAC,aAAA,EAAAC,cAAA;EAAA,IALJC,OAAO,GAAAH,IAAA,CAAPG,OAAO;IACPC,oBAAoB,GAAAJ,IAAA,CAApBI,oBAAoB;EAKpB,IAAAC,SAAA,GAA8C,IAAAC,eAAQ,EACpDC,IAAI,CAACC,SAAS,EAAAP,aAAA,GAACE,OAAO,CAACM,IAAI,qBAAZR,aAAA,CAAcS,gBAAiC,CAChE,CAAC;IAAAC,UAAA,OAAAC,eAAA,aAAAP,SAAA;IAFMK,gBAAgB,GAAAC,UAAA;IAAEE,iBAAiB,GAAAF,UAAA;EAG1C,IAAMG,uBAAuB,GAAGV,oBAAoB,GAChDG,IAAI,CAACC,SAAS,CAACO,MAAM,CAACC,MAAM,CAACZ,oBAAoB,CAAC,CAAC,GACnD,IAAI;EAGR,IAAAa,gBAAS,EAAC,YAAM;IAAA,IAAAC,cAAA;IACdL,iBAAiB,CAACN,IAAI,CAACC,SAAS,EAAAU,cAAA,GAACf,OAAO,CAACM,IAAI,qBAAZS,cAAA,CAAcR,gBAAiC,CAAC,CAAC;EACpF,CAAC,EAAE,EAAAR,cAAA,GAACC,OAAO,CAACM,IAAI,qBAAZP,cAAA,CAAcQ,gBAAgB,CAAC,CAAC;EAGpC,IAAAO,gBAAS,EAAC,YAAM;IACd,IAAME,QAAQ,GAAGhB,OAAO,CAACiB,EAAE,CAAC,sBAAsB,EAAE,UAACC,KAAK,EAAK;MAC7D,IAAIA,KAAK,CAACX,gBAAgB,EAAE;QAC1BG,iBAAiB,CAACN,IAAI,CAACC,SAAS,CAACa,KAAK,CAACX,gBAAiC,CAAC,CAAC;MAC5E;IACF,CAAC,CAAC;IAEF,OAAO,YAAM;MACXS,QAAQ,CAACG,WAAW,CAAC,CAAC;IACxB,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMC,sBAAmD,GAAG,IAAAC,cAAO,EAAC,YAAM;IACxE,IAAMC,YAAY,GAAIf,gBAAgB,IAAI,EAAoB;IAC9D,IAAMa,sBAAsB,GAAGR,MAAM,CAACW,IAAI,CAACC,0CAAkB,CAAC,CAACC,MAAM,CACnE,UAACC,MAAM,EAAEC,UAAU;MAAA,IAAAC,qBAAA;MAAA,WAAAC,SAAA,iBACdH,MAAM,MAAAI,gBAAA,iBACRH,UAAU,GAAAC,qBAAA,GACT3B,oBAAoB,oBAApBA,oBAAoB,CAAG0B,UAAU,CAAkB,YAAAC,qBAAA,GACnD,CAAC,CAACN,YAAY,CAACS,QAAQ,CAACP,0CAAkB,CAACG,UAAU,CAAkB,CAAC;IAAA,CAC1E,EACF,CAAC,CACH,CAAC;IAED,OAAOP,sBAAsB;EAC/B,CAAC,EAAE,CAACpB,OAAO,CAACgC,EAAE,EAAErB,uBAAuB,EAAEJ,gBAAgB,CAAC,CAAC;EAE3D,OAAOa,sBAAsB;AAC/B,CAAC;AAACa,OAAA,CAAArC,+BAAA,GAAAA,+BAAA"}