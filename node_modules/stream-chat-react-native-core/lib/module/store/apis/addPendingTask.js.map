{"version":3,"names":["_mapTaskToStorable","require","_QuickSqliteClient","_createDeleteQuery","_createUpsertQuery","addPendingTask","task","storable","mapTaskToStorable","channelId","channelType","payload","type","query","createUpsertQuery","QuickSqliteClient","logger","id","executeSql","apply","createDeleteQuery","exports"],"sources":["addPendingTask.ts"],"sourcesContent":["import { mapTaskToStorable } from '../mappers/mapTaskToStorable';\nimport { QuickSqliteClient } from '../QuickSqliteClient';\nimport { createDeleteQuery } from '../sqlite-utils/createDeleteQuery';\nimport { createUpsertQuery } from '../sqlite-utils/createUpsertQuery';\nimport type { PendingTask } from '../types';\n\n/*\n * addPendingTask - Adds a pending task to the database\n *\n * @param {PendingTask} task - The task to add\n *\n * @return {() => void} - A function that can be called to remove the task from the database\n */\nexport const addPendingTask = (task: PendingTask) => {\n  const storable = mapTaskToStorable(task);\n  const { channelId, channelType, payload, type } = storable;\n  const query = createUpsertQuery('pendingTasks', storable);\n  QuickSqliteClient.logger?.('info', 'addPendingTask', {\n    channelId,\n    channelType,\n    id: task.id,\n    type,\n  });\n\n  QuickSqliteClient.executeSql.apply(null, query);\n\n  return () => {\n    QuickSqliteClient.logger?.('info', 'deletePendingTaskAfterAddition', {\n      channelId,\n      channelType,\n      id: task.id,\n      type,\n    });\n    const query = createDeleteQuery('pendingTasks', {\n      channelId,\n      channelType,\n      payload,\n      type,\n    });\n\n    QuickSqliteClient.executeSql.apply(null, query);\n  };\n};\n"],"mappings":";;;;AAAA,IAAAA,kBAAA,GAAAC,OAAA;AACA,IAAAC,kBAAA,GAAAD,OAAA;AACA,IAAAE,kBAAA,GAAAF,OAAA;AACA,IAAAG,kBAAA,GAAAH,OAAA;AAUO,IAAMI,cAAc,GAAG,SAAjBA,cAAcA,CAAIC,IAAiB,EAAK;EACnD,IAAMC,QAAQ,GAAG,IAAAC,oCAAiB,EAACF,IAAI,CAAC;EACxC,IAAQG,SAAS,GAAiCF,QAAQ,CAAlDE,SAAS;IAAEC,WAAW,GAAoBH,QAAQ,CAAvCG,WAAW;IAAEC,OAAO,GAAWJ,QAAQ,CAA1BI,OAAO;IAAEC,IAAI,GAAKL,QAAQ,CAAjBK,IAAI;EAC7C,IAAMC,KAAK,GAAG,IAAAC,oCAAiB,EAAC,cAAc,EAAEP,QAAQ,CAAC;EACzDQ,oCAAiB,CAACC,MAAM,oBAAxBD,oCAAiB,CAACC,MAAM,CAAG,MAAM,EAAE,gBAAgB,EAAE;IACnDP,SAAS,EAATA,SAAS;IACTC,WAAW,EAAXA,WAAW;IACXO,EAAE,EAAEX,IAAI,CAACW,EAAE;IACXL,IAAI,EAAJA;EACF,CAAC,CAAC;EAEFG,oCAAiB,CAACG,UAAU,CAACC,KAAK,CAAC,IAAI,EAAEN,KAAK,CAAC;EAE/C,OAAO,YAAM;IACXE,oCAAiB,CAACC,MAAM,oBAAxBD,oCAAiB,CAACC,MAAM,CAAG,MAAM,EAAE,gCAAgC,EAAE;MACnEP,SAAS,EAATA,SAAS;MACTC,WAAW,EAAXA,WAAW;MACXO,EAAE,EAAEX,IAAI,CAACW,EAAE;MACXL,IAAI,EAAJA;IACF,CAAC,CAAC;IACF,IAAMC,KAAK,GAAG,IAAAO,oCAAiB,EAAC,cAAc,EAAE;MAC9CX,SAAS,EAATA,SAAS;MACTC,WAAW,EAAXA,WAAW;MACXC,OAAO,EAAPA,OAAO;MACPC,IAAI,EAAJA;IACF,CAAC,CAAC;IAEFG,oCAAiB,CAACG,UAAU,CAACC,KAAK,CAAC,IAAI,EAAEN,KAAK,CAAC;EACjD,CAAC;AACH,CAAC;AAACQ,OAAA,CAAAhB,cAAA,GAAAA,cAAA"}