{"version":3,"names":["_convertFilterSortToQuery","require","_QuickSqliteClient","_createUpsertQuery","upsertCidsForQuery","_ref","cids","filters","_ref$flush","flush","sort","cidsString","JSON","stringify","id","convertFilterSortToQuery","query","createUpsertQuery","QuickSqliteClient","logger","executeSql","apply","exports"],"sources":["upsertCidsForQuery.ts"],"sourcesContent":["import type { ChannelFilters, ChannelSort } from 'stream-chat';\n\nimport { convertFilterSortToQuery } from './utils/convertFilterSortToQuery';\n\nimport { QuickSqliteClient } from '../QuickSqliteClient';\nimport { createUpsertQuery } from '../sqlite-utils/createUpsertQuery';\n\nexport const upsertCidsForQuery = ({\n  cids,\n  filters,\n  flush = true,\n  sort,\n}: {\n  cids: string[];\n  filters?: ChannelFilters;\n  flush?: boolean;\n  sort?: ChannelSort;\n}) => {\n  // Update the database only if the query is provided.\n  const cidsString = JSON.stringify(cids);\n  const id = convertFilterSortToQuery({ filters, sort });\n  const query = createUpsertQuery('channelQueries', {\n    cids: cidsString,\n    id,\n  });\n\n  QuickSqliteClient.logger?.('info', 'upsertCidsForQuery', {\n    cids: cidsString,\n    flush,\n    id,\n  });\n\n  if (flush) {\n    QuickSqliteClient.executeSql.apply(null, query);\n  }\n\n  return [query];\n};\n"],"mappings":";;;;AAEA,IAAAA,yBAAA,GAAAC,OAAA;AAEA,IAAAC,kBAAA,GAAAD,OAAA;AACA,IAAAE,kBAAA,GAAAF,OAAA;AAEO,IAAMG,kBAAkB,GAAG,SAArBA,kBAAkBA,CAAAC,IAAA,EAUzB;EAAA,IATJC,IAAI,GAAAD,IAAA,CAAJC,IAAI;IACJC,OAAO,GAAAF,IAAA,CAAPE,OAAO;IAAAC,UAAA,GAAAH,IAAA,CACPI,KAAK;IAALA,KAAK,GAAAD,UAAA,cAAG,IAAI,GAAAA,UAAA;IACZE,IAAI,GAAAL,IAAA,CAAJK,IAAI;EAQJ,IAAMC,UAAU,GAAGC,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC;EACvC,IAAMQ,EAAE,GAAG,IAAAC,kDAAwB,EAAC;IAAER,OAAO,EAAPA,OAAO;IAAEG,IAAI,EAAJA;EAAK,CAAC,CAAC;EACtD,IAAMM,KAAK,GAAG,IAAAC,oCAAiB,EAAC,gBAAgB,EAAE;IAChDX,IAAI,EAAEK,UAAU;IAChBG,EAAE,EAAFA;EACF,CAAC,CAAC;EAEFI,oCAAiB,CAACC,MAAM,oBAAxBD,oCAAiB,CAACC,MAAM,CAAG,MAAM,EAAE,oBAAoB,EAAE;IACvDb,IAAI,EAAEK,UAAU;IAChBF,KAAK,EAALA,KAAK;IACLK,EAAE,EAAFA;EACF,CAAC,CAAC;EAEF,IAAIL,KAAK,EAAE;IACTS,oCAAiB,CAACE,UAAU,CAACC,KAAK,CAAC,IAAI,EAAEL,KAAK,CAAC;EACjD;EAEA,OAAO,CAACA,KAAK,CAAC;AAChB,CAAC;AAACM,OAAA,CAAAlB,kBAAA,GAAAA,kBAAA"}