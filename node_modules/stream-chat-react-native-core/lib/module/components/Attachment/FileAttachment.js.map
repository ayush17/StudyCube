{"version":3,"names":["_react","_interopRequireDefault","require","_reactNative","_openUrlSafely","_AttachmentActions","_FileIcon","_MessageContext","_MessagesContext","_ThemeContext","_useViewport2","_this","_jsxFileName","styles","StyleSheet","create","container","alignItems","borderRadius","flexDirection","padding","details","paddingLeft","size","fontSize","title","fontWeight","FileAttachmentWithContext","props","_attachment$actions","additionalTouchableProps","attachment","attachmentSize","AttachmentActions","FileAttachmentIcon","onLongPress","onPress","onPressIn","preventPress","_props$styles","stylesProp","_useTheme","useTheme","_useTheme$theme","theme","_useTheme$theme$color","colors","black","grey","white","_useTheme$theme$messa","messageSimple","file","fileSize","_useViewport","useViewport","vw","defaultOnPress","openUrlSafely","asset_url","createElement","TouchableOpacity","_extends2","disabled","event","additionalInfo","emitter","defaultHandler","testID","__self","__source","fileName","lineNumber","columnNumber","View","style","backgroundColor","mimeType","mime_type","maxWidth","Text","numberOfLines","color","getFileSizeDisplayText","file_size","actions","length","FileAttachment","_useMessageContext","useMessageContext","_useMessagesContext","useMessagesContext","_useMessagesContext$A","AttachmentActionsDefault","_useMessagesContext$F","FileIconDefault","exports","parseFloat","Math","floor","displayName"],"sources":["FileAttachment.tsx"],"sourcesContent":["import React from 'react';\nimport {\n  StyleProp,\n  StyleSheet,\n  Text,\n  TextStyle,\n  TouchableOpacity,\n  View,\n  ViewStyle,\n} from 'react-native';\n\nimport type { Attachment } from 'stream-chat';\n\nimport { openUrlSafely } from './utils/openUrlSafely';\n\nimport { AttachmentActions as AttachmentActionsDefault } from '../../components/Attachment/AttachmentActions';\nimport { FileIcon as FileIconDefault } from '../../components/Attachment/FileIcon';\nimport {\n  MessageContextValue,\n  useMessageContext,\n} from '../../contexts/messageContext/MessageContext';\nimport {\n  MessagesContextValue,\n  useMessagesContext,\n} from '../../contexts/messagesContext/MessagesContext';\nimport { useTheme } from '../../contexts/themeContext/ThemeContext';\nimport { useViewport } from '../../hooks/useViewport';\nimport type { DefaultStreamChatGenerics } from '../../types/types';\n\nconst styles = StyleSheet.create({\n  container: {\n    alignItems: 'center',\n    borderRadius: 12,\n    flexDirection: 'row',\n    padding: 8,\n  },\n  details: {\n    paddingLeft: 16,\n  },\n  size: {\n    fontSize: 12,\n  },\n  title: {\n    fontSize: 14,\n    fontWeight: '700',\n  },\n});\n\nexport type FileAttachmentPropsWithContext<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Pick<\n  MessageContextValue<StreamChatGenerics>,\n  'onLongPress' | 'onPress' | 'onPressIn' | 'preventPress'\n> &\n  Pick<\n    MessagesContextValue<StreamChatGenerics>,\n    'additionalTouchableProps' | 'AttachmentActions' | 'FileAttachmentIcon'\n  > & {\n    /** The attachment to render */\n    attachment: Attachment<StreamChatGenerics>;\n    attachmentSize?: number;\n    styles?: Partial<{\n      container: StyleProp<ViewStyle>;\n      details: StyleProp<ViewStyle>;\n      size: StyleProp<TextStyle>;\n      title: StyleProp<TextStyle>;\n    }>;\n  };\n\nconst FileAttachmentWithContext = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: FileAttachmentPropsWithContext<StreamChatGenerics>,\n) => {\n  const {\n    additionalTouchableProps,\n    attachment,\n    attachmentSize,\n    AttachmentActions,\n    FileAttachmentIcon,\n    onLongPress,\n    onPress,\n    onPressIn,\n    preventPress,\n    styles: stylesProp = {},\n  } = props;\n\n  const {\n    theme: {\n      colors: { black, grey, white },\n      messageSimple: {\n        file: { container, details, fileSize, title },\n      },\n    },\n  } = useTheme();\n  const { vw } = useViewport();\n\n  const defaultOnPress = () => openUrlSafely(attachment.asset_url);\n\n  return (\n    <TouchableOpacity\n      disabled={preventPress}\n      onLongPress={(event) => {\n        if (onLongPress) {\n          onLongPress({\n            additionalInfo: { attachment },\n            emitter: 'fileAttachment',\n            event,\n          });\n        }\n      }}\n      onPress={(event) => {\n        if (onPress) {\n          onPress({\n            additionalInfo: { attachment },\n            defaultHandler: defaultOnPress,\n            emitter: 'fileAttachment',\n            event,\n          });\n        }\n      }}\n      onPressIn={(event) => {\n        if (onPressIn) {\n          onPressIn({\n            additionalInfo: { attachment },\n            defaultHandler: defaultOnPress,\n            emitter: 'fileAttachment',\n            event,\n          });\n        }\n      }}\n      testID='file-attachment'\n      {...additionalTouchableProps}\n    >\n      <View style={[styles.container, { backgroundColor: white }, container, stylesProp.container]}>\n        <FileAttachmentIcon mimeType={attachment.mime_type} size={attachmentSize} />\n        <View\n          style={[\n            styles.details,\n            {\n              maxWidth: vw(60),\n            },\n            details,\n            stylesProp.details,\n          ]}\n        >\n          <Text numberOfLines={2} style={[styles.title, { color: black }, title, stylesProp.title]}>\n            {attachment.title}\n          </Text>\n          <Text style={[styles.size, { color: grey }, fileSize, stylesProp.size]}>\n            {getFileSizeDisplayText(attachment.file_size)}\n          </Text>\n        </View>\n      </View>\n      {attachment.actions?.length ? <AttachmentActions {...attachment} /> : null}\n    </TouchableOpacity>\n  );\n};\n\nexport type FileAttachmentProps<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Partial<Omit<FileAttachmentPropsWithContext<StreamChatGenerics>, 'attachment'>> &\n  Pick<FileAttachmentPropsWithContext<StreamChatGenerics>, 'attachment'>;\n\nexport const FileAttachment = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: FileAttachmentProps<StreamChatGenerics>,\n) => {\n  const { onLongPress, onPress, onPressIn, preventPress } = useMessageContext<StreamChatGenerics>();\n  const {\n    additionalTouchableProps,\n    AttachmentActions = AttachmentActionsDefault,\n    FileAttachmentIcon = FileIconDefault,\n  } = useMessagesContext<StreamChatGenerics>();\n\n  return (\n    <FileAttachmentWithContext\n      {...{\n        additionalTouchableProps,\n        AttachmentActions,\n        FileAttachmentIcon,\n        onLongPress,\n        onPress,\n        onPressIn,\n        preventPress,\n      }}\n      {...props}\n    />\n  );\n};\n\nexport const getFileSizeDisplayText = (size?: number | string) => {\n  if (!size) return;\n  if (typeof size === 'string') {\n    size = parseFloat(size);\n  }\n\n  if (size < 1000 * 1000) {\n    return `${Math.floor(Math.floor(size / 10) / 100)} KB`;\n  }\n\n  return `${Math.floor(Math.floor(size / 10000) / 100)} MB`;\n};\n\nFileAttachment.displayName = 'FileAttachment{messageSimple{file}}';\n"],"mappings":"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"}