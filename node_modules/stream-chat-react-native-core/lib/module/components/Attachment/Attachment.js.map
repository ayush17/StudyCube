{"version":3,"names":["_react","_interopRequireDefault","require","_AttachmentActions","_Card","_FileAttachment","_Gallery","_Giphy","_MessagesContext","_native","_this","_jsxFileName","AttachmentWithContext","props","_attachment$actions","attachment","AttachmentActions","Card","FileAttachment","Gallery","Giphy","giphyVersion","UrlPreview","hasAttachmentActions","actions","length","type","createElement","__self","__source","fileName","lineNumber","columnNumber","og_scrape_url","title_link","_extends2","Fragment","images","key","id","isVideoPackageAvailable","videos","areEqual","prevProps","nextProps","_prevAttachment$actio","_nextAttachment$actio","prevAttachment","isAttachmentEqual","prevMyMessageTheme","myMessageTheme","nextAttachment","nextMyMessageTheme","attachmentEqual","image_url","thumb_url","messageThemeEqual","JSON","stringify","MemoizedAttachment","React","memo","Attachment","PropAttachmentActions","PropCard","PropFileAttachment","PropGallery","PropGiphy","PropGiphyVersion","PropMyMessageTheme","PropUrlPreview","_useMessagesContext","useMessagesContext","ContextAttachmentActions","ContextCard","ContextFileAttachment","ContextGallery","ContextGiphy","ContextGiphyVersion","ContextMyMessageTheme","ContextUrlPreview","AttachmentActionsDefault","CardDefault","FileAttachmentDefault","GalleryDefault","GiphyDefault","exports"],"sources":["Attachment.tsx"],"sourcesContent":["import React from 'react';\n\nimport type { Attachment as AttachmentType } from 'stream-chat';\n\nimport { AttachmentActions as AttachmentActionsDefault } from '../../components/Attachment/AttachmentActions';\nimport { Card as CardDefault } from '../../components/Attachment/Card';\nimport { FileAttachment as FileAttachmentDefault } from '../../components/Attachment/FileAttachment';\nimport { Gallery as GalleryDefault } from '../../components/Attachment/Gallery';\nimport { Giphy as GiphyDefault } from '../../components/Attachment/Giphy';\nimport {\n  MessagesContextValue,\n  useMessagesContext,\n} from '../../contexts/messagesContext/MessagesContext';\nimport { isVideoPackageAvailable } from '../../native';\n\nimport type { DefaultStreamChatGenerics } from '../../types/types';\n\nexport type ActionHandler = (name: string, value: string) => void;\n\nexport type AttachmentPropsWithContext<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Pick<\n  MessagesContextValue<StreamChatGenerics>,\n  | 'AttachmentActions'\n  | 'Card'\n  | 'FileAttachment'\n  | 'Gallery'\n  | 'giphyVersion'\n  | 'Giphy'\n  | 'isAttachmentEqual'\n  | 'UrlPreview'\n  | 'myMessageTheme'\n> & {\n  /**\n   * The attachment to render\n   */\n  attachment: AttachmentType<StreamChatGenerics>;\n};\n\nconst AttachmentWithContext = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: AttachmentPropsWithContext<StreamChatGenerics>,\n) => {\n  const {\n    attachment,\n    AttachmentActions,\n    Card,\n    FileAttachment,\n    Gallery,\n    Giphy,\n    giphyVersion,\n    UrlPreview,\n  } = props;\n\n  const hasAttachmentActions = !!attachment.actions?.length;\n\n  if (attachment.type === 'giphy' || attachment.type === 'imgur') {\n    return <Giphy attachment={attachment} giphyVersion={giphyVersion} />;\n  }\n\n  if (attachment.og_scrape_url || attachment.title_link) {\n    return <UrlPreview {...attachment} />;\n  }\n\n  if (attachment.type === 'image') {\n    return (\n      <>\n        <Gallery images={[attachment]} />\n        {hasAttachmentActions && (\n          <AttachmentActions key={`key-actions-${attachment.id}`} {...attachment} />\n        )}\n      </>\n    );\n  }\n\n  if (attachment.type === 'video' && !attachment.og_scrape_url) {\n    return isVideoPackageAvailable() ? (\n      <>\n        <Gallery videos={[attachment]} />\n        {hasAttachmentActions && (\n          <AttachmentActions key={`key-actions-${attachment.id}`} {...attachment} />\n        )}\n      </>\n    ) : (\n      <FileAttachment attachment={attachment} />\n    );\n  }\n\n  if (attachment.type === 'file' || attachment.type === 'audio') {\n    return <FileAttachment attachment={attachment} />;\n  }\n\n  if (hasAttachmentActions) {\n    return (\n      <>\n        <Card {...attachment} />\n        <AttachmentActions key={`key-actions-${attachment.id}`} {...attachment} />\n      </>\n    );\n  } else {\n    return <Card {...attachment} />;\n  }\n};\n\nconst areEqual = <StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics>(\n  prevProps: AttachmentPropsWithContext<StreamChatGenerics>,\n  nextProps: AttachmentPropsWithContext<StreamChatGenerics>,\n) => {\n  const {\n    attachment: prevAttachment,\n    isAttachmentEqual,\n    myMessageTheme: prevMyMessageTheme,\n  } = prevProps;\n  const { attachment: nextAttachment, myMessageTheme: nextMyMessageTheme } = nextProps;\n\n  const attachmentEqual =\n    prevAttachment.actions?.length === nextAttachment.actions?.length &&\n    prevAttachment.image_url === nextAttachment.image_url &&\n    prevAttachment.thumb_url === nextAttachment.thumb_url;\n  if (!attachmentEqual) return false;\n\n  if (isAttachmentEqual) {\n    return isAttachmentEqual(prevAttachment, nextAttachment);\n  }\n\n  const messageThemeEqual =\n    JSON.stringify(prevMyMessageTheme) === JSON.stringify(nextMyMessageTheme);\n  if (!messageThemeEqual) return false;\n\n  return true;\n};\n\nconst MemoizedAttachment = React.memo(\n  AttachmentWithContext,\n  areEqual,\n) as typeof AttachmentWithContext;\n\nexport type AttachmentProps<\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n> = Partial<\n  Pick<\n    MessagesContextValue<StreamChatGenerics>,\n    | 'AttachmentActions'\n    | 'Card'\n    | 'FileAttachment'\n    | 'Gallery'\n    | 'Giphy'\n    | 'giphyVersion'\n    | 'myMessageTheme'\n    | 'UrlPreview'\n    | 'isAttachmentEqual'\n  >\n> &\n  Pick<AttachmentPropsWithContext<StreamChatGenerics>, 'attachment'>;\n\n/**\n * Attachment - The message attachment\n */\nexport const Attachment = <\n  StreamChatGenerics extends DefaultStreamChatGenerics = DefaultStreamChatGenerics,\n>(\n  props: AttachmentProps<StreamChatGenerics>,\n) => {\n  const {\n    attachment,\n    AttachmentActions: PropAttachmentActions,\n    Card: PropCard,\n    FileAttachment: PropFileAttachment,\n    Gallery: PropGallery,\n    Giphy: PropGiphy,\n    giphyVersion: PropGiphyVersion,\n    myMessageTheme: PropMyMessageTheme,\n    UrlPreview: PropUrlPreview,\n  } = props;\n\n  const {\n    AttachmentActions: ContextAttachmentActions,\n    Card: ContextCard,\n    FileAttachment: ContextFileAttachment,\n    Gallery: ContextGallery,\n    Giphy: ContextGiphy,\n    giphyVersion: ContextGiphyVersion,\n    isAttachmentEqual,\n    myMessageTheme: ContextMyMessageTheme,\n    UrlPreview: ContextUrlPreview,\n  } = useMessagesContext<StreamChatGenerics>();\n\n  if (!attachment) {\n    return null;\n  }\n\n  const AttachmentActions =\n    PropAttachmentActions || ContextAttachmentActions || AttachmentActionsDefault;\n  const Card = PropCard || ContextCard || CardDefault;\n  const FileAttachment = PropFileAttachment || ContextFileAttachment || FileAttachmentDefault;\n  const Gallery = PropGallery || ContextGallery || GalleryDefault;\n  const Giphy = PropGiphy || ContextGiphy || GiphyDefault;\n  const UrlPreview = PropUrlPreview || ContextUrlPreview || CardDefault;\n  const giphyVersion = PropGiphyVersion || ContextGiphyVersion;\n  const myMessageTheme = PropMyMessageTheme || ContextMyMessageTheme;\n\n  return (\n    <MemoizedAttachment\n      {...{\n        attachment,\n        AttachmentActions,\n        Card,\n        FileAttachment,\n        Gallery,\n        Giphy,\n        giphyVersion,\n        isAttachmentEqual,\n        myMessageTheme,\n        UrlPreview,\n      }}\n    />\n  );\n};\n"],"mappings":"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"}